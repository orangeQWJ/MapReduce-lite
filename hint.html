<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>/Users/bytedance/code/MapReduce-lite/hint.md</title>
<meta name="colorscheme" content="tokyonight-moon"></meta>
<style>
* {font-family: AnonymicePro Nerd Font,monospace}
body {background-color: #222436; color: #c8d3f5}
.-variable-parameter {color: #ffc777}
.-none {}
.Type {color: #65bcff}
.-spell {}
.Constant {color: #ff966c}
.CursorColumn {background-color: #2f334d}
.-punctuation-special {color: #89ddff}
.-label {color: #82aaff}
.RainbowDelimiterRed {color: #ff757f}
.String {color: #c3e88d}
.-keyword {font-style: italic; color: #fca7ea}
.RainbowDelimiterYellow {color: #ffc777}
.-nospell {}
.mkdSnippetPY {}
.-markup-link {color: #4fd6be}
.-markup-list-markdown {font-weight: bold; color: #ff966c}
.Special {color: #65bcff}
.-constructor {color: #c099ff}
.-markup-heading-1-markdown {font-weight: bold; color: #82aaff}
.-punctuation-delimiter {color: #89ddff}
.-markup-heading-2-markdown {font-weight: bold; color: #ffc777}
.-variable {color: #c8d3f5}
.Function {color: #82aaff}
.-keyword-function {color: #c099ff}
.-punctuation-bracket {color: #828bb8}
</style>
</head>
<body style="display: flex">
<pre>
<span class="-markup-heading-1-markdown"># <span class="-spell">worker</span>
</span>
<span class="-markup-heading-1-markdown"># <span class="-spell">master</span>
</span>
<span class="-markup-heading-1-markdown"># <span class="-spell">worker</span>
</span>



<span class="-markup-heading-1-markdown"># <span class="-spell">编程范式</span>
</span>
<span class="-spell">业务诉求是统计文本中所有字符的数量</span>
<span class="String"><span class="String"><span class="String"></span><span class="-label"><span class="-label"></span></span></span>
<span class="mkdSnippetPY"><span class="-keyword-function">def</span> <span class="-variable"><span class="Function">map</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="-variable"><span class="-variable-parameter">filename</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span><span class="-punctuation-delimiter">:</span></span>
<span class="mkdSnippetPY">    <span class="-punctuation-delimiter">...</span></span>
<span class="mkdSnippetPY">    <span class="-variable"><span class="Type"><span class="Function"><span class="-constructor">Emit</span></span></span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="-variable">k</span><span class="-punctuation-delimiter">,</span><span class="-variable">v</span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span></span>

<span class="mkdSnippetPY"><span class="String">&quot;&quot;&quot;</span></span><span class="String">
<span class="mkdSnippetPY">a:1</span>
<span class="mkdSnippetPY">a:1</span>
<span class="mkdSnippetPY">b:1</span>
<span class="mkdSnippetPY">b:1</span>
<span class="mkdSnippetPY">c:1</span>


<span class="mkdSnippetPY">x:1</span>
<span class="mkdSnippetPY">y:1</span>
<span class="mkdSnippetPY">z:1</span>


<span class="mkdSnippetPY">&quot;&quot;&quot;</span></span><span class="mkdSnippetPY"></span>
<span class="mkdSnippetPY">        </span>
<span class="mkdSnippetPY"><span class="-keyword-function">def</span> <span class="-variable"><span class="Function">reduce</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="-variable"><span class="-variable-parameter">key</span></span><span class="-punctuation-delimiter">,</span> <span class="-variable"><span class="-variable-parameter">value_list</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span><span class="-punctuation-delimiter">:</span></span>
<span class="mkdSnippetPY">    <span class="-keyword">return</span> <span class="-variable">key</span><span class="-punctuation-delimiter">,</span> <span class="-variable"><span class="Function"><span class="Special">len</span></span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="-variable">value_list</span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span></span>



<span class="mkdSnippetPY"><span class="-variable"><span class="Function">reduce</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="String">&quot;a&quot;</span><span class="-punctuation-delimiter">,</span> <span class="-punctuation-bracket"><span class="RainbowDelimiterYellow">[</span></span><span class="Constant">1</span><span class="-punctuation-delimiter">,</span><span class="Constant">1</span><span class="-punctuation-bracket"><span class="RainbowDelimiterYellow">]</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span></span>
<span class="mkdSnippetPY"><span class="-variable"><span class="Function">reduce</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="String">&quot;b&quot;</span><span class="-punctuation-delimiter">,</span><span class="-punctuation-bracket"><span class="RainbowDelimiterYellow">[</span></span><span class="Constant">1</span><span class="-punctuation-delimiter">,</span><span class="Constant">1</span><span class="-punctuation-bracket"><span class="RainbowDelimiterYellow">]</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span></span>

<span class="mkdSnippetPY"><span class="-variable"><span class="Function">reduce</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">(</span></span><span class="String">&quot;x&quot;</span><span class="-punctuation-delimiter">,</span><span class="-punctuation-bracket"><span class="RainbowDelimiterYellow">[</span></span><span class="Constant">1</span><span class="-punctuation-bracket"><span class="RainbowDelimiterYellow">]</span></span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">)</span></span></span>
<span class="mkdSnippetPY"><span class="-punctuation-delimiter">...</span><span class="-punctuation-delimiter">.</span></span>

<span class="String"><span class="String"></span></span>
</span>
<span class="-markup-heading-1-markdown"># <span class="-spell">分布式计算框架</span>
</span>
<span class="-none"><span class="-punctuation-special">&gt; </span><span class="-spell">在局域网内, 每个节点都有自己的ip地址</span>
</span>
<span class="-spell">import sourcefile</span>

<span class="-spell">go 动态链接 .o</span>

<span class="-spell">Job
M task
R task</span>

<span class="-spell">map 阶段, reduce 阶段.</span>

<span class="-spell">M = 2
R = 4</span>

<span class="-spell">mapreduce  配合 gfs
文件传输</span>

<span class="-markup-heading-2-markdown">## <span class="-spell">文件的位置</span>
</span>
<span class="-markup-list-markdown">- </span><span class="-spell">绝对路径</span>
<span class="-markup-list-markdown">- </span><span class="-spell">ip, port</span>


<span class="-markup-heading-2-markdown">## <span class="-spell">client</span> 
</span>
<span class="-spell">hugefile -&gt; split</span>

<span class="-markup-list-markdown">1. </span><span class="-spell">m-0</span>
<span class="-markup-list-markdown">2. </span><span class="-spell">m-1</span>

<span class="-spell">拉取 r1 r2 r3</span>


<span class="-markup-heading-2-markdown">## <span class="-spell">master</span>
</span><span class="-spell">单点故障
性能瓶颈</span>

<span class="-spell">先忽略</span>

<span class="-spell">0-0 0-1 0-2 0-3</span>

<span class="-spell">1-0 1-1 1-2 1-3</span>


<span class="-spell"><span class="-markup-link"></span><span class="-nospell"><span class="Special"> r1, r2 ,r3</span></span><span class="-markup-link"></span></span>


<span class="-spell">jobID
 uuid   产生一个唯一的ID</span>

<span class="String"><span class="String"><span class="String"></span><span class="-label"><span class="-label"></span></span></span>
<span class="mkdSnippetPY"><span class="-variable">job_Dict</span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">[</span></span><span class="-variable">uuid</span><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">]</span></span> <span class="-punctuation-bracket"><span class="RainbowDelimiterRed">{</span></span></span>
<span class="mkdSnippetPY">    <span class="-variable">status</span> <span class="-variable">done</span></span>

<span class="mkdSnippetPY"><span class="-punctuation-bracket"><span class="RainbowDelimiterRed">}</span></span></span>
<span class="String"><span class="String"></span></span>
</span>
<span class="-spell">jobQueue</span>

<span class="-spell">taskQueue
     {m-1-task}  {r-0}    {r-1}</span>


<span class="-spell"><span class="CursorColumn">workerQueue</span>
     {ip, port} {ip, port}</span>
    



<span class="-spell">{task, worker}</span>



<span class="-markup-heading-2-markdown">## <span class="-spell">worker1</span>
</span>
<span class="-markup-list-markdown">- </span><span class="-spell">m-0 (26字母都有)</span>

<span class="-spell">产生 巨量的 k,v</span>

<span class="-spell">hash(k) % R</span>

<span class="-spell">r-0-0      a,b,c
r-0-1      x,y,z
r-0-2      j,k,l
r-0-3       m,o,n</span>

<span class="-punctuation-special">---
</span><span class="-spell">0-3
1-3</span>

<span class="-spell">r3
    m:3
    o:78
    n:79</span>

<span class="-markup-heading-2-markdown">## <span class="-spell">worker2</span>
</span>
<span class="-markup-list-markdown">- </span><span class="-spell">m-1</span>

<span class="-spell">产生 巨量的 k,v</span>

<span class="-spell">hash(k) % R</span>

<span class="-spell">r-1-0      a,b,c
r-1-1      x,y,z
r-1-2      j,k,l
r-1-3       m,o,n</span>

<span class="-punctuation-special">---
</span><span class="-spell">0-2
1-2</span>

<span class="-spell">j:10
k:11
l:12</span>

<span class="-markup-heading-2-markdown">## <span class="-spell">worker3</span>
</span><span class="-spell">0-0
1-0</span>


<span class="-markup-heading-2-markdown">## <span class="-spell">worker4</span>
</span><span class="-spell">0-1
1-1</span>

</pre>
</body>
</html>
